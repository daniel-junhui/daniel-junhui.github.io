---
title: LR分析法
top_img: false
cover: /img/compiler.jpg
date: 2020-11-30 13:05:40
tags:
- 编译原理
katex: true
---

LR分析法是比较麻烦的一种自底向上的分析方法。整体思路在于**寻找句柄**和**最左规约**。

在分析字符串时，将待分析字符串从左至右push到stack中，一旦出现句柄，就规约。需要构造一个**LR(0)分析表**

## LR(0)分析法

### 一个例子
文法$G[S]$：
$$
\begin{aligned}
&E\rightarrow aA \\
&E\rightarrow bB\\
&A\rightarrow cA\\
&A\rightarrow d\\
&B\rightarrow cB\\
&B\rightarrow d
\end{aligned}
$$
把该文法托广：

$$
\begin{aligned}
&0.\;S^{'}\rightarrow E\\
&1.\;E\rightarrow aA \\
&2.\;E\rightarrow bB\\
&3.\;A\rightarrow cA\\
&4.\;A\rightarrow d\\
&5.\;B\rightarrow cB\\
&6.\;B\rightarrow d
\end{aligned}
$$

推出识别**活前缀**的DFA：
{% img "/img/com.png" %}

得到DFA后由此得到LR(0)分析表：

| 状态 | a     | b     | c     | d     | $     | E    | A    | B    |
| ---- | ----- | ----- | ----- | ----- | ----- | ---- | ---- | ---- |
| 0    | $S_1$ | $S_2$ |       |       |       | $3$  |      |      |
| 1    |       |       | $S_4$ | $S_5$ |       |      | $6$  |      |
| 2    |       |       | $S_7$ | $S_8$ |       |      |      | $9$  |
| 3    |       |       |       |       | $acc$ |      |      |      |
| 4    |       |       | $S_4$ | $S_5$ |       |      | $10$ |      |
| 5    | $r_4$ | $r_4$ | $r_4$ | $r_4$ | $r_4$ |      |      |      |
| 6    | $r_1$ | $r_1$ | $r_1$ | $r_1$ | $r_1$ |      |      |      |
| 7    |       |       | $S_7$ | $S_8$ |       |      |      | $11$ |
| 8    | $r_6$ | $r_6$ | $r_6$ | $r_6$ | $r_6$ |      |      |      |
| 9    | $r_2$ | $r_2$ | $r_2$ | $r_2$ | $r_2$ |      |      |      |
| 10   | $r_3$ | $r_3$ | $r_3$ | $r_3$ | $r_3$ |      |      |      |
| 11   | $r_5$ | $r_5$ | $r_5$ | $r_5$ | $r_5$ |      |      |      |

在得到分析表后，对于任意字符串，从**状态0**开始，启动自动机。对于读入的下一个字符$\alpha$与当前的状态，定位到分析表中的元素。
- 如果该元素是$S_{j}$，则将这个字符push to stack，并且从当前状态转换到状态$j$。
- 如果该元素是$r_{j}$，则根据（扩展）文法中第$j$条规则，从stack中pop出**与该规则右部字符串长度相同个数的字符**；然后把规则左部的**非终结字符**push to stack，如果该非终结字符为$A$，则当前状态转换到分析表中**当前状态**和**$A$**所定位到的状态数。
- 如果遇到分析表中的空值，则抛出一个error，分析出错。
- 如果遇到$acc$，分析结束。

LR(0)的分析逻辑还算比较简单，但仍然有几个问题未解决：
1. 文法的活前缀是什么？
2. 如何得到文法活前缀的DFA？
3. 如何由DFA得到分析表？


### 